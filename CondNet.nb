(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42150,        933]
NotebookOptionsPosition[     37744,        865]
NotebookOutlinePosition[     38086,        880]
CellTagsIndexPosition[     38043,        877]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["CondNet  2.0 \n", "Title",
  FontFamily->"Utopia",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["Deep learning architecture for estimation of dielectric properties \
using MRI scans\n", "Title",
  FontFamily->"Utopia",
  FontSize->24,
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["\nEssam Rashed (c) 2020 @ NITech, Japan \
(essam.rashed@nitech.ac.jp)\n",
  FontFamily->"Source Code Pro",
  FontSize->14,
  FontWeight->"Plain",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["References: ",
  FontFamily->"Source Code Pro",
  FontSize->14,
  FontWeight->"Plain",
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\n(1) Rashed, et al, \[OpenCurlyDoubleQuote]Deep learning-based \
development of personalized human head model with non-uniform conductivity \
for brain stimulation,\[CloseCurlyDoubleQuote] IEEE TMI, 2020 \
(\[AHat]\.80\.8bDOI: 10.1109/TMI.2020.2969682)\n(2) Rashed, et al, \
\[OpenCurlyDoubleQuote]Learning-based estimation of dielectric properties and \
tissue density in head models for personalized radio-frequency dosimetry,\
\[CloseCurlyDoubleQuote] Phys. Med. Biol., 2020 (DOI: \
10.1088/1361-6560/ab7308)\n\nLast update: 5 Mar. 2020\n",
  FontFamily->"Source Code Pro",
  FontSize->14,
  FontWeight->"Plain",
  FontColor->RGBColor[0, 0, 1]]
}], "Title",
 CellChangeTimes->{{3.74892351049205*^9, 3.74892369823372*^9}, {
   3.749167681856616*^9, 3.7491677446896267`*^9}, {3.7491679895634403`*^9, 
   3.749167990202631*^9}, {3.749171468044774*^9, 3.749171469531754*^9}, {
   3.749184281323601*^9, 3.749184301880286*^9}, {3.749241745645048*^9, 
   3.749241746204126*^9}, {3.749241795647564*^9, 3.749241835149988*^9}, {
   3.752815010011116*^9, 3.752815034168871*^9}, {3.752815671116115*^9, 
   3.752815690986676*^9}, {3.752875132909789*^9, 3.752875179897293*^9}, 
   3.752878850411211*^9, {3.752977471794961*^9, 3.752977515603724*^9}, {
   3.7533976562319107`*^9, 3.7533976583062897`*^9}, {3.753402776507723*^9, 
   3.7534028463113947`*^9}, 3.753402944523135*^9, {3.753403553377976*^9, 
   3.753403568355207*^9}, {3.7534037360367126`*^9, 3.753403736922435*^9}, {
   3.75349804148811*^9, 3.753498042233445*^9}, {3.7534984001899548`*^9, 
   3.753498425386454*^9}, {3.753512429196314*^9, 3.753512630317462*^9}, {
   3.753753109329463*^9, 3.7537532279275503`*^9}, {3.7537532756270313`*^9, 
   3.7537532949083557`*^9}, {3.7537534043470087`*^9, 
   3.7537534604591913`*^9}, {3.753753544341243*^9, 3.753753552220665*^9}, {
   3.753753602504183*^9, 3.753753727602655*^9}, 3.753753801942245*^9, {
   3.753753868348963*^9, 3.753753877456559*^9}, {3.753753926031163*^9, 
   3.7537539278047132`*^9}, {3.753754161066535*^9, 3.753754173358058*^9}, {
   3.7537544834884157`*^9, 3.7537544998567877`*^9}, {3.753754810619499*^9, 
   3.7537548608030653`*^9}, {3.7537549086448383`*^9, 3.753754914275263*^9}, {
   3.753755003747654*^9, 3.753755060211144*^9}, {3.75375515535425*^9, 
   3.7537551618054323`*^9}, {3.753756318125739*^9, 3.753756345513481*^9}, {
   3.755899941795198*^9, 3.755900022504961*^9}, {3.755900170302047*^9, 
   3.755900192447057*^9}, {3.755900267193136*^9, 3.755900296043651*^9}, {
   3.755912251982359*^9, 3.755912298775446*^9}, {3.756161909875474*^9, 
   3.756162043735346*^9}, {3.756435197017518*^9, 3.756435217352363*^9}, {
   3.756513371489191*^9, 3.75651340964776*^9}, {3.756592099069408*^9, 
   3.756592118044404*^9}, {3.757043511133102*^9, 3.7570435558685637`*^9}, {
   3.757043733692625*^9, 3.757043781387183*^9}, 3.757112344631073*^9, {
   3.757112624430728*^9, 3.757112644950506*^9}, {3.757203502504942*^9, 
   3.757203602013139*^9}, {3.75721417513311*^9, 3.757214201979862*^9}, {
   3.757560964023637*^9, 3.757560991457918*^9}, {3.757567476577846*^9, 
   3.757567477878076*^9}, {3.75762433206194*^9, 3.75762438167341*^9}, {
   3.757624461262907*^9, 3.757624512160347*^9}, {3.7577117325242443`*^9, 
   3.757711759015335*^9}, {3.759794651011661*^9, 3.7597946523698263`*^9}, {
   3.761529027472905*^9, 3.761529039901902*^9}, {3.761531669806044*^9, 
   3.761531672478573*^9}, 3.771628419566306*^9, {3.7716347800770283`*^9, 
   3.771634789623756*^9}, {3.771638300466566*^9, 3.771638318178507*^9}, {
   3.7717215762794113`*^9, 3.771721596437667*^9}, 3.7717940856161957`*^9, {
   3.772222620068592*^9, 3.772222624899815*^9}, {3.7722345671495733`*^9, 
   3.772234568764612*^9}, {3.772234832966448*^9, 3.772234836175723*^9}, {
   3.775191684921941*^9, 3.7751917555456*^9}, {3.776486667917912*^9, 
   3.7764866782049828`*^9}, 3.777154556679833*^9, {3.777324623690352*^9, 
   3.777324662728298*^9}, {3.779401878053069*^9, 3.779401909347866*^9}, {
   3.7794877562931433`*^9, 3.779487764916606*^9}, {3.77948780264795*^9, 
   3.7794878169178677`*^9}, {3.7795845069150467`*^9, 3.779584544694487*^9}, 
   3.779584629846572*^9, {3.779678937126581*^9, 3.77967894408667*^9}, {
   3.779679138649887*^9, 3.7796791462944613`*^9}, 3.779682157242074*^9, {
   3.780093514708941*^9, 3.7800935149932823`*^9}, {3.7800935686625223`*^9, 
   3.780093571828166*^9}, {3.7801002248971653`*^9, 3.7801002537390223`*^9}, {
   3.792458720392488*^9, 
   3.792458789368116*^9}},ExpressionUUID->"bb06eeb8-40e8-4898-acd1-\
bf9343c4b4d5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Experiment", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Parameters", " ", "--"}], "--"}], "--"}], "--"}],
                     "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.753752314801449*^9, 3.753752330657073*^9}, {
   3.756162095056327*^9, 3.756162098368149*^9}, 3.7722226304374027`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"08a03a4e-11d7-441c-817d-a01d316d048d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "NotebookEvaluate", "[", 
   "\"\</home/essam/Github/CondNet/Notebooks/parameters.nb\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771639447613035*^9, 3.7716395013533697`*^9}, 
   3.7722344916300087`*^9, {3.775191822442955*^9, 3.7751918247137613`*^9}, {
   3.779413494532699*^9, 3.779413496872118*^9}, {3.792458797480946*^9, 
   3.79245880238918*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d01f6bd7-5852-49d7-815e-fccfce7b9739"],

Cell[CellGroupData[{

Cell[BoxData["\<\"CondNet ver.  2.0 (FreeModel)\"\>"], "Print",
 CellChangeTimes->{3.792459192147545*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"6325e0b5-aa9e-408c-9ca2-a1e26532d054"],

Cell[BoxData["\<\"Direction: [T] Epochs: [50] Batch Size: [4]\"\>"], "Print",
 CellChangeTimes->{3.792459192173993*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"c0c16358-bdf3-4e9d-be8e-014465dd6ae8"],

Cell[BoxData["\<\"Network Architecture: [arch01] Frequency [900MHz]\"\>"], \
"Print",
 CellChangeTimes->{3.792459192208963*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"2b52a4e7-3d0f-4c30-8b99-b75a89941af4"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "LOAD"}]}]}]}]}]}]}]}]}]}]}], " ", "DATA"}],
          " ", "&"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Preprocessing", "--"}], "--"}], "--"}]}], "--"}], "--"}], 
     "--"}], "--"}], "-"}], "*)"}]], "Input",
 CellChangeTimes->{3.749180760399023*^9, 3.772222633523892*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"1b1e2dc9-c69b-4d0a-8747-d492240897f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", "ReadTrainName", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.771637702603664*^9, 3.7716377063154793`*^9}, 
   3.771639938208375*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"b0a8af43-1a61-4415-9127-fe393ea43305"],

Cell[CellGroupData[{

Cell[BoxData["\<\"[1/5] Reading MRI (T1)...\"\>"], "Print",
 CellChangeTimes->{3.792459192327548*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"cd4d0dcb-a154-4dc7-ba1f-581b5cec0b3d"],

Cell[BoxData["\<\"[2/5] Reading MRI (T2)...\"\>"], "Print",
 CellChangeTimes->{3.79245922299214*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"37af977b-d193-4ef3-8e86-37731b95e79d"],

Cell[BoxData["\<\"[3/5] Reading Conductivity...\"\>"], "Print",
 CellChangeTimes->{3.792459260253099*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"b57fe30d-208f-43e6-9bbc-a07ead7c91cc"],

Cell[BoxData["\<\"[4/5] Reading Permittivity...\"\>"], "Print",
 CellChangeTimes->{3.7924592945154*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"1c3cc728-65e8-4a2d-ba20-a1f1725d046f"],

Cell[BoxData["\<\"[5/5] Reading Density...\"\>"], "Print",
 CellChangeTimes->{3.792459328444878*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"0cf08b24-4b0d-4703-8822-21b93fd4a469"],

Cell[BoxData["\<\"[Done.]\"\>"], "Print",
 CellChangeTimes->{3.792459362305513*^9},
 CellLabel->
  "During evaluation of \
In[71]:=",ExpressionUUID->"5f9b7f5e-8d97-43f0-81f9-65d2a5fbe8a8"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "Preparing"}]}]}]}]}]}]}]}]}]}]}], " ", "Data", 
    " ", "for", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"SubForkNet", "--"}], "--"}], "--"}]}], "-", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.753750063770671*^9, 3.7537501211806173`*^9}, 
   3.753750262107339*^9, 3.7537522140515327`*^9, {3.757316531849683*^9, 
   3.757316541892467*^9}, {3.772222640067399*^9, 3.772222649091477*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"a230645f-883d-4512-86d5-ae8741f36eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
    RowBox[{"Dimensions", "[", "anaT1", "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.753655283619246*^9, 3.7536552932475853`*^9}, 
   3.757112846356634*^9, 3.757116389629012*^9, 3.757120674487133*^9, 
   3.7571208356085377`*^9, 3.761530179576989*^9, {3.7716388077476883`*^9, 
   3.77163881698582*^9}, {3.7716402319182*^9, 3.771640234800177*^9}, 
   3.7722226520195704`*^9, {3.77526480622291*^9, 3.775264806753003*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"e6708bbb-afcf-4be9-bd6a-97625d86de00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imagesT1", "=", 
   RowBox[{"Image3DSlices", "[", 
    RowBox[{"Image3D", "[", "anaT1", "]"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "anaT1", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.753482379695827*^9, 3.753482382108797*^9}, 
   3.753496457631076*^9, {3.7571128486309557`*^9, 3.757112852082877*^9}, {
   3.7571163861588*^9, 3.757116391596746*^9}, {3.757120642918284*^9, 
   3.757120648963847*^9}, {3.771640156287383*^9, 3.771640158973034*^9}, {
   3.775264810111649*^9, 3.775264817022584*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"3f72f34c-b165-476c-82a8-626e5e350dd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imagesT2", "=", 
   RowBox[{"Image3DSlices", "[", 
    RowBox[{"Image3D", "[", "anaT2", "]"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "anaT2", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.753482379695827*^9, 3.753482382108797*^9}, 
   3.753496457631076*^9, {3.7571128486309557`*^9, 3.757112852082877*^9}, {
   3.7571163861588*^9, 3.757116391596746*^9}, {3.757120642918284*^9, 
   3.757120648963847*^9}, {3.771640156287383*^9, 3.771640158973034*^9}, {
   3.775264810111649*^9, 3.775264833838674*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"834d7330-1fcb-431c-8e65-cba4b0eb11da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shuffledimagesT1", "=", 
   RowBox[{"RandomSample", "@", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "imagesT1"}]}], "\[Rule]", "imagesT1"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.753481501780724*^9, 3.7534815111758738`*^9}, {
  3.75349558108165*^9, 3.753495583675735*^9}, {3.7571128649378643`*^9, 
  3.757112869667398*^9}, {3.7571163972924137`*^9, 3.757116402319862*^9}, {
  3.775264838656044*^9, 3.7752648418389683`*^9}, {3.775264915871399*^9, 
  3.7752649163193207`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"47ac7db5-1871-4136-80c1-20bcc8378d89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"keysshuffle", "=", 
   RowBox[{"Keys", "@", "shuffledimagesT1"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.753481516550537*^9, {3.753495587881756*^9, 3.753495589526662*^9}, {
   3.757112873222431*^9, 3.757112875941163*^9}, {3.7571164069246683`*^9, 
   3.757116408186287*^9}, {3.7752649194754868`*^9, 3.775264920046673*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"5310331e-669a-4864-9e11-936ef03cde93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shuffledimagesT2", "=", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "imagesT2"}]}], "\[Rule]", "imagesT2"}], 
       "]"}], "|>"}], ",", "keysshuffle"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "imagesT2", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.752878040967293*^9, 3.752878046296371*^9}, 
   3.753481533254095*^9, {3.7534955984797573`*^9, 3.7534956161996737`*^9}, {
   3.753498557997745*^9, 3.753498562708634*^9}, {3.753500662108364*^9, 
   3.753500671281184*^9}, {3.753749611591693*^9, 3.753749619381564*^9}, 
   3.753749666358533*^9, {3.7571128785499983`*^9, 3.757112902883658*^9}, {
   3.757116396029681*^9, 3.757116432027082*^9}, {3.77155215026466*^9, 
   3.77155215138311*^9}, {3.77155228665105*^9, 3.771552290280126*^9}, {
   3.775264855599923*^9, 3.775264873646804*^9}, {3.775264929423533*^9, 
   3.7752649366393948`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"fecad576-327c-467a-9c8d-9bdc2c034df7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mskd1", "=", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "CondAll"}]}], "\[Rule]", "CondAll"}], "]"}], 
      "|>"}], ",", "keysshuffle"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "CondAll", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.753505928565448*^9, 3.7535059328373404`*^9}, {
   3.753510931955298*^9, 3.753510932393754*^9}, {3.753749628048294*^9, 
   3.753749630105303*^9}, 3.753749670904324*^9, {3.7571128815607367`*^9, 
   3.757112904326269*^9}, {3.7571164108847103`*^9, 3.757116434270507*^9}, {
   3.771552160649254*^9, 3.771552161432292*^9}, {3.771552296205304*^9, 
   3.7715523106173162`*^9}, {3.7719106060371532`*^9, 3.77191061092023*^9}, {
   3.775264898353799*^9, 3.775264901392164*^9}, 3.775264942575712*^9, {
   3.792458896840794*^9, 3.7924589104073973`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ec1e4173-cf30-4cd0-b8d6-6eaecac38df3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mskd2", "=", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "PermAll"}]}], "\[Rule]", "PermAll"}], "]"}], 
      "|>"}], ",", "keysshuffle"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "PermAll", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.753505928565448*^9, 3.7535059328373404`*^9}, {
   3.753510931955298*^9, 3.753510932393754*^9}, {3.753749628048294*^9, 
   3.753749630105303*^9}, 3.753749670904324*^9, {3.7571128815607367`*^9, 
   3.757112904326269*^9}, {3.7571164108847103`*^9, 3.757116434270507*^9}, {
   3.771552160649254*^9, 3.771552161432292*^9}, {3.771552296205304*^9, 
   3.7715523106173162`*^9}, {3.7719106060371532`*^9, 3.77191061092023*^9}, {
   3.775264898353799*^9, 3.775264901392164*^9}, 3.775264942575712*^9, {
   3.775877503925788*^9, 3.775877509888956*^9}, {3.792458914902033*^9, 
   3.792458928358506*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"2218e3b8-53d0-4aa5-a500-096a76ef9a66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mskd3", "=", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "DenAll"}]}], "\[Rule]", "DenAll"}], "]"}], 
      "|>"}], ",", "keysshuffle"}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "DenAll", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.753505928565448*^9, 3.7535059328373404`*^9}, {
   3.753510931955298*^9, 3.753510932393754*^9}, {3.753749628048294*^9, 
   3.753749630105303*^9}, 3.753749670904324*^9, {3.7571128815607367`*^9, 
   3.757112904326269*^9}, {3.7571164108847103`*^9, 3.757116434270507*^9}, {
   3.771552160649254*^9, 3.771552161432292*^9}, {3.771552296205304*^9, 
   3.7715523106173162`*^9}, {3.7719106060371532`*^9, 3.77191061092023*^9}, {
   3.775264898353799*^9, 3.775264901392164*^9}, 3.775264942575712*^9, {
   3.775877503925788*^9, 3.775877509888956*^9}, {3.779679074503336*^9, 
   3.779679080341954*^9}, {3.7924589325693693`*^9, 3.7924589443745832`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"7695a804-0d6d-48e2-a8af-732e090d0ae3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MRIT1", "=", 
   RowBox[{"Values", "@", "shuffledimagesT1"}]}], ";", " ", 
  RowBox[{"Clear", "[", "shuffledimagesT1", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7528154457126703`*^9, 3.752815470075314*^9}, 
   3.752818157500496*^9, {3.752875461292577*^9, 3.752875477848516*^9}, {
   3.752875547690523*^9, 3.752875566345916*^9}, {3.7528780014462957`*^9, 
   3.752878002084096*^9}, {3.7528780502762127`*^9, 3.752878060691414*^9}, {
   3.752977684341707*^9, 3.7529776935411177`*^9}, {3.7534036587241383`*^9, 
   3.753403665648405*^9}, 3.7534815358198147`*^9, {3.7535005917550783`*^9, 
   3.753500608058024*^9}, {3.75350207556746*^9, 3.753502092121217*^9}, {
   3.753581771691358*^9, 3.753581778997326*^9}, {3.753581838704852*^9, 
   3.753581846556364*^9}, {3.753582046285612*^9, 3.7535820682517843`*^9}, {
   3.7535981755963573`*^9, 3.753598192226454*^9}, {3.753655962915189*^9, 
   3.7536559769314537`*^9}, {3.755912618745088*^9, 3.755912624619495*^9}, {
   3.755918440280467*^9, 3.755918452238364*^9}, {3.755919628474609*^9, 
   3.7559196420205727`*^9}, {3.757112931461006*^9, 3.757112935734158*^9}, {
   3.7571164478240147`*^9, 3.757116449147376*^9}, 3.757117409576489*^9, {
   3.761530209891966*^9, 3.761530220743637*^9}, {3.7716401389094877`*^9, 
   3.771640148080845*^9}, {3.775264951983267*^9, 3.7752649595033407`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"6bfb0b1b-b3e8-4d9d-be2c-b13871a1d23a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MRIT2", "=", "shuffledimagesT2"}], ";", " ", 
  RowBox[{"Clear", "[", "shuffledimagesT2", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7528154457126703`*^9, 3.752815470075314*^9}, 
   3.752818157500496*^9, {3.752875461292577*^9, 3.752875477848516*^9}, {
   3.752875547690523*^9, 3.752875566345916*^9}, {3.7528780014462957`*^9, 
   3.752878002084096*^9}, {3.7528780502762127`*^9, 3.752878060691414*^9}, {
   3.752977684341707*^9, 3.7529776935411177`*^9}, {3.7534036587241383`*^9, 
   3.753403665648405*^9}, 3.7534815358198147`*^9, {3.7535005917550783`*^9, 
   3.753500608058024*^9}, {3.75350207556746*^9, 3.753502092121217*^9}, {
   3.753581771691358*^9, 3.753581778997326*^9}, {3.753581838704852*^9, 
   3.753581846556364*^9}, {3.753582046285612*^9, 3.7535820682517843`*^9}, {
   3.7535981755963573`*^9, 3.753598192226454*^9}, {3.753655962915189*^9, 
   3.7536559769314537`*^9}, {3.755912618745088*^9, 3.755912624619495*^9}, {
   3.755918440280467*^9, 3.755918452238364*^9}, {3.755919628474609*^9, 
   3.7559196420205727`*^9}, {3.757112931461006*^9, 3.757112935734158*^9}, {
   3.7571164478240147`*^9, 3.757116449147376*^9}, 3.757117409576489*^9, {
   3.761530209891966*^9, 3.761530220743637*^9}, {3.7716401389094877`*^9, 
   3.771640148080845*^9}, {3.775264951983267*^9, 3.775264993520216*^9}, 
   3.775265072095903*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"1d4c348b-e4e6-4802-98ca-17564c0234a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labels1d", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"mskd1", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "mskd1", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.75358215361521*^9, 3.753582174626883*^9}, 
   3.753598283468207*^9, {3.753656001986998*^9, 3.753656008913753*^9}, {
   3.7537497318318853`*^9, 3.7537497432112923`*^9}, {3.757112958213756*^9, 
   3.757112967171386*^9}, {3.7571164792664843`*^9, 3.757116488539526*^9}, 
   3.761530275273959*^9, {3.77155231850636*^9, 3.771552322841137*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"b39149b6-fa22-4bf5-8c22-03087f6849a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labels2d", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"mskd2", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "mskd2", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.75358215361521*^9, 3.753582174626883*^9}, 
   3.753598283468207*^9, {3.753656001986998*^9, 3.753656008913753*^9}, {
   3.7537497318318853`*^9, 3.7537497432112923`*^9}, {3.757112958213756*^9, 
   3.757112967171386*^9}, {3.7571164792664843`*^9, 3.757116488539526*^9}, 
   3.761530275273959*^9, {3.77155231850636*^9, 3.771552322841137*^9}, {
   3.775877519103848*^9, 3.7758775217290277`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"fef25db9-5b0d-4f53-975b-31cd47daa22f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labels3d", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"mskd3", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Clear", "[", "mskd3", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.75358215361521*^9, 3.753582174626883*^9}, 
   3.753598283468207*^9, {3.753656001986998*^9, 3.753656008913753*^9}, {
   3.7537497318318853`*^9, 3.7537497432112923`*^9}, {3.757112958213756*^9, 
   3.757112967171386*^9}, {3.7571164792664843`*^9, 3.757116488539526*^9}, 
   3.761530275273959*^9, {3.77155231850636*^9, 3.771552322841137*^9}, {
   3.775877519103848*^9, 3.7758775217290277`*^9}, {3.779679087208716*^9, 
   3.7796790917518597`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"a04778e8-1e25-447d-bb4d-d2ab162c04f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "labels1d", "]"}]], "Input",
 CellChangeTimes->{{3.771652950152302*^9, 3.771653006293988*^9}, {
  3.771653041095653*^9, 3.7716530468203573`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"9ef39b0a-d1d4-42d3-bbfd-11da51f9a274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2560", ",", "1", ",", "256", ",", "256"}], "}"}]], "Output",
 CellChangeTimes->{3.792459109138883*^9, 3.792459384141288*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"7374af68-7d9c-44a0-bb9a-a5a0b7ead474"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "Construct"}]}]}]}]}]}]}]}]}]}]}], " ", "Network",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Modules", "--"}], "--"}], "--"}]}], "-", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.749160460330285*^9, 3.749160463981484*^9}, {
   3.7537540070737457`*^9, 3.753754030573264*^9}, 3.753754070646834*^9, 
   3.7722226637671824`*^9, 3.7752733579854593`*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"be48a973-95c9-49b6-a365-bfd1c0c29f3e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NotebookEvaluate", "[", "ArchName", "]"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"N", "=", " ", 
    RowBox[{
     RowBox[{"2", "--"}], ">", 
     RowBox[{"3", " ", "branches", " ", "architecture"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.756592081882153*^9, 3.756592083438553*^9}, {
   3.756593274266226*^9, 3.756593274870644*^9}, {3.756593375098868*^9, 
   3.756593404057249*^9}, {3.756593551963952*^9, 3.756593569543461*^9}, 
   3.7570433754330797`*^9, {3.7579800249668493`*^9, 3.757980026117722*^9}, {
   3.759124450802758*^9, 3.759124474239852*^9}, {3.7608586874892197`*^9, 
   3.760858701349378*^9}, 3.7615184780895576`*^9, {3.761531780546082*^9, 
   3.761531781117893*^9}, 3.761604266770553*^9, 3.761613251221704*^9, 
   3.761619212193098*^9, 3.7616254829114532`*^9, {3.771539252034047*^9, 
   3.771539261965975*^9}, 3.771540797386539*^9, {3.771634960924553*^9, 
   3.771634986873341*^9}, {3.771637897516815*^9, 3.771637898974657*^9}, 
   3.7716383449757433`*^9, {3.7716395789083767`*^9, 3.7716395794491787`*^9}, {
   3.771639609933712*^9, 3.7716396103961983`*^9}, {3.771817955835374*^9, 
   3.77181795626655*^9}, 3.772222599572461*^9, {3.775265141218576*^9, 
   3.775265143538322*^9}, 3.7794039295043097`*^9, 3.779682084487205*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"24937880-0664-49a7-a2da-9ce28db8f734"],

Cell[BoxData["\<\"Network Architecture...\"\>"], "Print",
 CellChangeTimes->{3.7924593842258863`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"be7bca87-4cb0-480a-a323-8fbd2fc7aaf8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "TRAIN"}]}]}]}]}]}]}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"NETWORK", "--"}], "--"}], "--"}]}], "-", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.749180926839899*^9, 3.7491809291346083`*^9}, 
   3.772222665593185*^9, 3.7752733615146437`*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"9fb893b7-0f0f-43b5-b69e-f546182b4e53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logFile", "=", 
   RowBox[{"CreateTemporary", "[", "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "save", " ", "training", " ", "data", " ", "into", " ", "TMP", " ", 
    "file"}], " ", "*)"}], 
  RowBox[{"appendToLog", "=", 
   RowBox[{
    RowBox[{"PutAppend", "[", 
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Batch\>\"", "\[Rule]", "#AbsoluteBatch"}], ",", 
        RowBox[{"\"\<Loss\>\"", "\[Rule]", "#RoundLoss"}], ",", 
        RowBox[{"\"\<VLoss\>\"", "\[Rule]", "#ValidationLoss"}]}], 
       RowBox[{"(*", 
        RowBox[{",", " ", 
         RowBox[{"\"\<Error\>\"", "\[Rule]", "#RoundErrorRate"}]}], "*)"}], 
       "|>"}], ",", "logFile"}], "]"}], "&"}]}], ";", 
  RowBox[{"TN", "=", 
   RowBox[{"NetTrain", "[", 
    RowBox[{"CondNET", ",", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Input1\>\"", " ", "\[Rule]", "MRIT1"}], ",", 
       RowBox[{"\"\<Input2\>\"", "\[Rule]", "MRIT2"}], ",", 
       RowBox[{"\"\<Output1\>\"", "\[Rule]", "labels1d"}], ",", 
       RowBox[{"\"\<Output2\>\"", "\[Rule]", "labels2d"}], ",", 
       RowBox[{"\"\<Output3\>\"", "\[Rule]", "labels3d"}]}], "|>"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BatchSize", "\[Rule]", "BS"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ValidationSet", "\[Rule]", 
      RowBox[{"Scaled", "[", "0.1", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MaxTrainingRounds", "\[Rule]", "Epochs"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"TargetDevice", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<GPU\>\"", ",", "3"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"TrainingProgressFunction", "\[Rule]", "appendToLog"}]}], 
    "\[IndentingNewLine]", " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7528923126840153`*^9, 3.752892323210475*^9}, {
   3.7534949571599894`*^9, 3.753494962711824*^9}, {3.753495854576621*^9, 
   3.7534958557532063`*^9}, 3.753497109836812*^9, {3.753498233963657*^9, 
   3.753498234491576*^9}, {3.753500758955188*^9, 3.753500770792852*^9}, {
   3.753500972496809*^9, 3.753500976450741*^9}, {3.753501545232807*^9, 
   3.7535015695158253`*^9}, {3.753501601620249*^9, 3.753501605142626*^9}, {
   3.753501678913107*^9, 3.753501683205841*^9}, {3.75350196716754*^9, 
   3.7535019824887466`*^9}, {3.7535020280454187`*^9, 
   3.7535020358839893`*^9}, {3.7535023091892023`*^9, 3.75350232646257*^9}, {
   3.753502469699752*^9, 3.753502484964128*^9}, {3.753502580803392*^9, 
   3.7535026112952423`*^9}, 3.753502648242688*^9, 3.7535047947060204`*^9, {
   3.7535059787924*^9, 3.7535059918714333`*^9}, {3.753509768638771*^9, 
   3.7535097750345497`*^9}, 3.753510727318572*^9, 3.7535780527641773`*^9, {
   3.7535793233272*^9, 3.753579324747533*^9}, {3.753581433325955*^9, 
   3.7535814427015553`*^9}, {3.7535814915951443`*^9, 
   3.7535815782852087`*^9}, {3.753581681731287*^9, 3.75358170761045*^9}, {
   3.75358192740876*^9, 3.753581928427945*^9}, {3.753582287357547*^9, 
   3.753582324829526*^9}, {3.753582856043832*^9, 3.753582856850296*^9}, {
   3.753583144086906*^9, 3.7535831441805*^9}, {3.753583811962327*^9, 
   3.753583821679089*^9}, 3.753585081843851*^9, {3.753585217702911*^9, 
   3.753585315205152*^9}, {3.7535862981574574`*^9, 3.7535863092440977`*^9}, {
   3.753588064603486*^9, 3.75358811296129*^9}, {3.753588538567254*^9, 
   3.753588558998933*^9}, 3.753600057529098*^9, {3.753656253046254*^9, 
   3.753656256357978*^9}, 3.753656372369419*^9, {3.7536678908917627`*^9, 
   3.753667891424721*^9}, 3.753741700972168*^9, 3.753742260176405*^9, {
   3.75374985420041*^9, 3.753749878472701*^9}, 3.753749943039747*^9, {
   3.753751646897501*^9, 3.7537516534877253`*^9}, {3.755908416631464*^9, 
   3.7559084182300367`*^9}, 3.7559127478040133`*^9, {3.757113021112555*^9, 
   3.7571130381977577`*^9}, {3.75711745176248*^9, 3.757117471207033*^9}, {
   3.759537146724524*^9, 3.7595371498762493`*^9}, {3.759709340095549*^9, 
   3.759709357534075*^9}, {3.759712567075432*^9, 3.759712577171317*^9}, {
   3.7606686023409348`*^9, 3.7606686104675007`*^9}, {3.761529201318606*^9, 
   3.761529207498363*^9}, 3.761530330353962*^9, 3.761531054497429*^9, {
   3.771552364285014*^9, 3.771552393946031*^9}, {3.771552495308494*^9, 
   3.7715524973218603`*^9}, {3.771638702594963*^9, 3.771638704210552*^9}, {
   3.771640776776297*^9, 3.7716408100471888`*^9}, 3.771640854616479*^9, 
   3.7716408877099133`*^9, {3.771728464833569*^9, 3.771728493301094*^9}, {
   3.771906139688101*^9, 3.771906156499454*^9}, {3.771910734856058*^9, 
   3.77191077788231*^9}, 3.7722225312703*^9, 3.772417476238926*^9, 
   3.772418696892769*^9, {3.775265155764183*^9, 3.775265212530714*^9}, {
   3.775265510248083*^9, 3.775265511093115*^9}, {3.7757787718352537`*^9, 
   3.775778774918852*^9}, {3.775785018695566*^9, 3.775785024796623*^9}, {
   3.775790577180126*^9, 3.7757905818400717`*^9}, {3.775877528722308*^9, 
   3.77587754812956*^9}, {3.7758778394472427`*^9, 3.775877839538295*^9}, {
   3.77587794586329*^9, 3.7758779609645853`*^9}, 3.7765569385856524`*^9, 
   3.776563155794242*^9, {3.777154500216407*^9, 3.777154508517502*^9}, {
   3.777323524280511*^9, 3.777323531190488*^9}, 3.779403277320664*^9, {
   3.779403698664339*^9, 3.779403701586894*^9}, {3.779679104184161*^9, 
   3.779679112617669*^9}, {3.779682092475356*^9, 3.7796820927626743`*^9}, 
   3.779682434716127*^9, {3.7924589596414022`*^9, 3.7924589598631496`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"b612781c-5a10-4d97-9bca-0f147e8a92cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataset", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"ReadList", "[", "logFile", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LossData", "=", 
   RowBox[{"dataset", "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Batch\>\"", ",", "\"\<Loss\>\""}], "}"}]}], "]"}]}], ";", 
  RowBox[{"VLossData", "=", 
   RowBox[{"dataset", "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Batch\>\"", ",", "\"\<VLoss\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LossPlot", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"LossData", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Loss\>\"", "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"DotDashed", ",", "Thick"}], "}"}]}]}], "]"}]}], ";", 
  RowBox[{"VLossPlot", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"VLossData", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<VLoss\>\"", "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", "Black", "}"}]}]}], "]"}]}], ";", 
  RowBox[{"Show", "[", 
   RowBox[{"LossPlot", ",", "VLossPlot"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.753583050935899*^9, 3.753583050936544*^9}, {
   3.7535835986916656`*^9, 3.753583619991453*^9}, {3.753584269645391*^9, 
   3.753584280176929*^9}, {3.75358484102571*^9, 3.753584871702133*^9}, {
   3.753584922801922*^9, 3.753584929359668*^9}, 3.753585194454074*^9, {
   3.753585346855797*^9, 3.753585383499215*^9}, {3.753585944572729*^9, 
   3.7535859970978813`*^9}, {3.753656384853303*^9, 3.7536563944233513`*^9}, {
   3.760235402284286*^9, 3.760235414059041*^9}, {3.760235690016433*^9, 
   3.760235789631219*^9}, {3.771817840796338*^9, 3.7718178865710793`*^9}, 
   3.772234806271288*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"1389ce63-a760-4a92-88d3-bc1eca7340e5"],

Cell[BoxData[
 RowBox[{"dataset", "[", "Last", "]"}]], "Input",
 CellChangeTimes->{{3.75358543379685*^9, 3.753585447483717*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"96cfe436-d302-43cf-b8d1-443907e9f0df"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.771817915226543*^9, 3.7718179183461323`*^9}, 
   3.775267131907034*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"3652682d-f6aa-48bd-9191-5060d6d4c0e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"NetworkName", ",", "TN"}], "]"}], ";"}], " ", 
  RowBox[{"(*", "NetworkName", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.753656422693387*^9, {3.753656509373851*^9, 3.753656513365068*^9}, {
   3.753747074455194*^9, 3.7537470881180353`*^9}, {3.7537499371459723`*^9, 
   3.7537499394478073`*^9}, 3.753751053070223*^9, {3.753751688366022*^9, 
   3.7537516913742113`*^9}, {3.753752124305316*^9, 3.7537521298396063`*^9}, {
   3.771804310471036*^9, 3.771804325250828*^9}, 3.771804382086076*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"a3edb0d6-6d9b-48e8-8cf2-a4b8f3412468"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"LossName", ",", "LossData", ",", "\"\<Table\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.76024969707056*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"87bf11df-15e2-4cf6-b269-0c8b24299fe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"VLossName", ",", "VLossData", ",", "\"\<Table\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.7602497005239162`*^9, {3.7603045400902567`*^9, 3.7603045459123287`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"4be9ecbe-5ed8-4987-b1cc-7e63c90eb1a7"]
}, Open  ]]
},
WindowSize->{879, 792},
WindowMargins->{{Automatic, 94}, {Automatic, 77}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5202, 88, 343, "Title",ExpressionUUID->"bb06eeb8-40e8-4898-acd1-bf9343c4b4d5"],
Cell[5785, 112, 1145, 34, 28, "Input",ExpressionUUID->"08a03a4e-11d7-441c-817d-a01d316d048d"],
Cell[CellGroupData[{
Cell[6955, 150, 476, 10, 28, "Input",ExpressionUUID->"d01f6bd7-5852-49d7-815e-fccfce7b9739"],
Cell[CellGroupData[{
Cell[7456, 164, 210, 4, 22, "Print",ExpressionUUID->"6325e0b5-aa9e-408c-9ca2-a1e26532d054"],
Cell[7669, 170, 224, 4, 22, "Print",ExpressionUUID->"c0c16358-bdf3-4e9d-be8e-014465dd6ae8"],
Cell[7896, 176, 232, 5, 22, "Print",ExpressionUUID->"2b52a4e7-3d0f-4c30-8b99-b75a89941af4"]
}, Open  ]]
}, Open  ]],
Cell[8155, 185, 849, 27, 28, "Input",ExpressionUUID->"1b1e2dc9-c69b-4d0a-8747-d492240897f3"],
Cell[CellGroupData[{
Cell[9029, 216, 272, 5, 28, "Input",ExpressionUUID->"b0a8af43-1a61-4415-9127-fe393ea43305"],
Cell[CellGroupData[{
Cell[9326, 225, 205, 4, 22, "Print",ExpressionUUID->"cd4d0dcb-a154-4dc7-ba1f-581b5cec0b3d"],
Cell[9534, 231, 205, 4, 22, "Print",ExpressionUUID->"37af977b-d193-4ef3-8e86-37731b95e79d"],
Cell[9742, 237, 210, 4, 22, "Print",ExpressionUUID->"b57fe30d-208f-43e6-9bbc-a07ead7c91cc"],
Cell[9955, 243, 208, 4, 22, "Print",ExpressionUUID->"1c3cc728-65e8-4a2d-ba20-a1f1725d046f"],
Cell[10166, 249, 205, 4, 22, "Print",ExpressionUUID->"0cf08b24-4b0d-4703-8822-21b93fd4a469"],
Cell[10374, 255, 188, 4, 22, "Print",ExpressionUUID->"5f9b7f5e-8d97-43f0-81f9-65d2a5fbe8a8"]
}, Open  ]]
}, Open  ]],
Cell[10589, 263, 901, 27, 28, "Input",ExpressionUUID->"a230645f-883d-4512-86d5-ae8741f36eed"],
Cell[11493, 292, 625, 12, 28, "Input",ExpressionUUID->"e6708bbb-afcf-4be9-bd6a-97625d86de00"],
Cell[12121, 306, 614, 11, 28, "Input",ExpressionUUID->"3f72f34c-b165-476c-82a8-626e5e350dd0"],
Cell[12738, 319, 614, 11, 28, "Input",ExpressionUUID->"834d7330-1fcb-431c-8e65-cba4b0eb11da"],
Cell[13355, 332, 664, 14, 28, "Input",ExpressionUUID->"47ac7db5-1871-4136-80c1-20bcc8378d89"],
Cell[14022, 348, 439, 8, 28, "Input",ExpressionUUID->"5310331e-669a-4864-9e11-936ef03cde93"],
Cell[14464, 358, 1075, 21, 48, "Input",ExpressionUUID->"fecad576-327c-467a-9c8d-9bdc2c034df7"],
Cell[15542, 381, 1016, 20, 28, "Input",ExpressionUUID->"ec1e4173-cf30-4cd0-b8d6-6eaecac38df3"],
Cell[16561, 403, 1064, 21, 28, "Input",ExpressionUUID->"2218e3b8-53d0-4aa5-a500-096a76ef9a66"],
Cell[17628, 426, 1111, 21, 28, "Input",ExpressionUUID->"7695a804-0d6d-48e2-a8af-732e090d0ae3"],
Cell[18742, 449, 1441, 21, 28, "Input",ExpressionUUID->"6bfb0b1b-b3e8-4d9d-be2c-b13871a1d23a"],
Cell[20186, 472, 1436, 21, 28, "Input",ExpressionUUID->"1d4c348b-e4e6-4802-98ca-17564c0234a2"],
Cell[21625, 495, 701, 13, 28, "Input",ExpressionUUID->"b39149b6-fa22-4bf5-8c22-03087f6849a2"],
Cell[22329, 510, 753, 14, 28, "Input",ExpressionUUID->"fef25db9-5b0d-4f53-975b-31cd47daa22f"],
Cell[23085, 526, 805, 15, 28, "Input",ExpressionUUID->"a04778e8-1e25-447d-bb4d-d2ab162c04f4"],
Cell[CellGroupData[{
Cell[23915, 545, 266, 4, 28, "Input",ExpressionUUID->"9ef39b0a-d1d4-42d3-bbfd-11da51f9a274"],
Cell[24184, 551, 243, 4, 32, "Output",ExpressionUUID->"7374af68-7d9c-44a0-bb9a-a5a0b7ead474"]
}, Open  ]],
Cell[24442, 558, 945, 30, 28, "Input",ExpressionUUID->"be48a973-95c9-49b6-a365-bfd1c0c29f3e"],
Cell[CellGroupData[{
Cell[25412, 592, 1390, 24, 28, "Input",ExpressionUUID->"24937880-0664-49a7-a2da-9ce28db8f734"],
Cell[26805, 618, 205, 4, 22, "Print",ExpressionUUID->"be7bca87-4cb0-480a-a323-8fbd2fc7aaf8"]
}, Open  ]],
Cell[27025, 625, 873, 29, 28, "Input",ExpressionUUID->"9fb893b7-0f0f-43b5-b69e-f546182b4e53"],
Cell[27901, 656, 5525, 93, 238, "Input",ExpressionUUID->"b612781c-5a10-4d97-9bca-0f147e8a92cc"],
Cell[33429, 751, 2039, 47, 105, "Input",ExpressionUUID->"1389ce63-a760-4a92-88d3-bc1eca7340e5"],
Cell[35471, 800, 207, 3, 28, "Input",ExpressionUUID->"96cfe436-d302-43cf-b8d1-443907e9f0df"],
Cell[35681, 805, 818, 26, 28, "Input",ExpressionUUID->"3652682d-f6aa-48bd-9191-5060d6d4c0e4"],
Cell[36502, 833, 642, 12, 28, "Input",ExpressionUUID->"a3edb0d6-6d9b-48e8-8cf2-a4b8f3412468"],
Cell[37147, 847, 260, 6, 28, "Input",ExpressionUUID->"87bf11df-15e2-4cf6-b269-0c8b24299fe6"],
Cell[37410, 855, 318, 7, 28, "Input",ExpressionUUID->"4be9ecbe-5ed8-4987-b1cc-7e63c90eb1a7"]
}, Open  ]]
}
]
*)

